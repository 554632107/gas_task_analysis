# 气体检测任务分析项目

本项目包含四个主要的气体检测分析模块，基于机器学习方法对气体检测数据进行全面的分类和回归分析。

## 📁 项目结构

```
gas_task_analysis/
├── gas_dataset.csv                             # 数据集文件
├── gas_classification_task_analysis.py         # 气体二分类任务分析
├── gas_concentration_regression_analysis.py    # 气体浓度回归任务分析
├── mixed_gas_classification_task.py           # 混合气体多分类任务
├── mixed_gas_regression_task.py               # 混合气体回归任务
└── README.md                                  # 项目说明文档
```

## 🎯 项目功能概述

### 1. 气体二分类任务分析 (`gas_classification_task_analysis.py`)
- **功能**: 针对每种气体分子，进行独立的二分类任务分析（该气体 vs 其他气体）
- **模型**: 逻辑回归、随机森林
- **评估指标**: 准确率、F1分数、精确率、召回率、置信度分析
- **特色功能**: 
  - 5折交叉验证置信区间计算
  - 详细的置信度分布分析
  - 模型预测置信度与准确率关系分析

### 2. 气体浓度回归分析 (`gas_concentration_regression_analysis.py`)
- **功能**: 针对每种气体分子，分别进行浓度值回归预测
- **模型**: 线性回归、随机森林回归
- **评估指标**: MAE、RMSE、R²、95%预测区间覆盖率
- **特色功能**:
  - 数据确定性关系验证
  - 残差分析与可视化
  - 按浓度分组的误差分析

### 3. 混合气体多分类任务 (`mixed_gas_classification_task.py`)
- **功能**: 将气体种类和浓度组合作为分类目标，进行多分类预测
- **模型**: 随机森林（网格搜索优化）
- **评估指标**: 准确率、F1分数、混淆矩阵、精确率-召回率曲线
- **特色功能**:
  - 网格搜索参数优化
  - 精确率-召回率曲线分析
  - 详细的混淆矩阵可视化

### 4. 混合气体回归任务 (`mixed_gas_regression_task.py`)
- **功能**: 综合所有气体数据，进行统一的浓度回归预测
- **模型**: 随机森林回归（网格搜索优化）
- **评估指标**: RMSE、MAE、R²、95%预测区间
- **特色功能**:
  - 网格搜索参数优化
  - 详细的残差分析
  - 特征重要性分析

## 📊 数据格式要求

项目需要名为 `gas_dataset.csv` 的数据文件，包含以下列：
- `气体种类`: 气体分子名称
- `气体浓度(ppm)`: 气体浓度值
- `测量结果`: 传感器测量数值
- `气体谱线(nm)`: 光谱线波长数据

## 🚀 使用方法

### 环境要求
```bash
pip install pandas numpy scikit-learn matplotlib seaborn scipy joblib
```

### 运行脚本

1. **气体二分类分析**
```bash
python gas_classification_task_analysis.py
```

2. **气体浓度回归分析**
```bash
python gas_concentration_regression_analysis.py
```

3. **混合气体分类任务**
```bash
python mixed_gas_classification_task.py
```

4. **混合气体回归任务**
```bash
python mixed_gas_regression_task.py
```

## 📈 输出结果

每个脚本都会在相应的输出目录中生成：

### 结果文件
- **CSV文件**: 详细的数值结果和统计数据
- **Excel文件**: 交叉验证结果和混淆矩阵
- **JSON文件**: 模型参数和性能指标
- **TXT文件**: 可读性强的结果摘要

### 可视化图表
- **性能对比图**: 不同模型和气体的性能比较
- **混淆矩阵**: 分类任务的详细混淆矩阵
- **残差分析图**: 回归任务的残差分布和Q-Q图
- **置信度分析图**: 模型预测置信度分布
- **特征重要性图**: 特征对预测结果的贡献度

### 输出目录结构
```
输出目录/
├── figures/                    # 所有可视化图表
├── detailed_results/          # 按气体分类的详细结果
├── cross_validation_data.csv  # 交叉验证数据
├── model_results.json        # 模型结果JSON格式
├── summary.csv              # 结果汇总表
└── best_rf_model.joblib     # 训练好的模型文件
```

## 🔧 核心技术特点

### 机器学习方法
- **随机森林**: 主要预测模型，具有良好的泛化能力
- **逻辑回归**: 基准对比模型，提供线性基线
- **网格搜索**: 自动化超参数优化
- **交叉验证**: 5折分层交叉验证，确保结果可靠性

### 数据处理
- **标准化**: StandardScaler标准化数值特征
- **分层抽样**: 确保训练测试集类别平衡
- **编码兼容**: 支持GBK和UTF-8编码自动识别

### 评估体系
- **分类指标**: 准确率、F1、精确率、召回率
- **回归指标**: MAE、RMSE、R²
- **置信度分析**: 预测置信度分布和阈值分析
- **统计检验**: 置信区间计算和显著性分析

## 📋 注意事项

1. **数据要求**: 确保CSV文件编码为GBK或UTF-8
2. **内存使用**: 网格搜索过程可能消耗较多内存
3. **运行时间**: 完整分析可能需要几分钟到几十分钟
4. **结果保存**: 所有结果自动保存，无需手动操作

## 🔬 技术细节

### 模型配置
- **随机森林**: 100-300棵树，最大深度5-20
- **交叉验证**: 5折分层采样
- **评分标准**: 分类用准确率，回归用均方误差
- **类别平衡**: 自动处理类别不平衡问题

### 可视化配置
- **中文支持**: 配置SimHei字体显示中文
- **高分辨率**: 300DPI输出，适合论文使用
- **颜色配置**: 使用色盲友好的配色方案

## 🎨 示例结果

运行完成后，您将获得：
- 📊 各种气体的分类准确率对比图
- 📈 回归预测的实际值vs预测值散点图  
- 🎯 详细的混淆矩阵热力图
- 📉 残差分析和Q-Q图
- 🔍 置信度分布直方图

## 💡 使用建议

1. **首次运行**: 建议从单个脚本开始，熟悉输出格式
2. **参数调整**: 可根据数据特点修改网格搜索参数
3. **结果解读**: 重点关注置信区间和交叉验证结果
4. **性能优化**: 如需加速，可减少网格搜索参数组合

## 📞 支持与反馈

如有问题或建议，请检查：
1. 数据文件格式是否正确
2. 依赖包是否完整安装
3. 输出目录是否有写入权限
4. Python版本是否兼容（推荐3.7+）

---

*本项目专注于气体检测数据的机器学习分析，提供了完整的分类和回归解决方案。*